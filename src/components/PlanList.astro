---
type Plan = {
  date: string;
  title: string;
  category: "é›‘è¨˜" | "åˆ†æ" | "å‰µä½œ" | "ç´¹ä»‹";
  status?: string;
};

const categoryIcon: Record<Plan["category"], string> = {
  é›‘è¨˜: "ğŸ—’ï¸",
  åˆ†æ: "ğŸª“",
  å‰µä½œ: "ğŸª„",
  ç´¹ä»‹: "ğŸ—ï¸",
};

const { plans, limit, title = "åŸ·ç­†äºˆå®š" } = Astro.props as {
  plans: Plan[];
  limit?: number;
  title?: string;
};

const BASE = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : import.meta.env.BASE_URL + "/";

const shown = typeof limit === "number" ? plans.slice(0, limit) : plans;

---
<section class="plainSection">
  <div class="sectionHead">
    <h2 class="h2" style="margin:0;">{title}</h2>
  </div>

  <ul class="postList">
    {shown.map((p) => (
      <li>
        <a class="postRow" data-category={p.category} href={`${BASE}date/${p.date}`}>
          <span class="left">
            <span class="icon" aria-hidden="true">{categoryIcon[p.category]}</span>
            <span class="category">{p.category}</span>
            <span class="sep">ï½œ</span>
            <strong class="title">
              {p.title}
              <span class="planMark">ï¼ˆäºˆå®šï¼‰</span>
            </strong>
          </span>

          <span class="right">
            <span class="date">{p.date}</span>
          </span>
        </a>
      </li>
    ))}
  </ul>
</section>

<style>
  .plainSection { padding: 0; margin: 0; }
  .sectionHead { margin: 0 0 8px; }
  .postList { list-style: none; padding: 0; margin: 0; }

  .postRow {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    padding: 8px 0;
    border-bottom: 1px dotted var(--line);
    text-decoration: none;
    color: var(--ink);
  }

  .left { display: flex; gap: 6px; align-items: baseline; flex-wrap: wrap; }

  .right {
    display: flex;
    gap: 10px;
    align-items: baseline;
    font-size: 0.85em;
    color: var(--muted);
    white-space: nowrap;
  }

  .category { font-size: 0.85em; color: var(--muted); }
  .sep { color: var(--muted); }

  .planMark {
    margin-left: 4px;
    font-weight: 400;
    font-size: 0.88em;
    color: var(--muted);
    opacity: 0.9;
  }

  @media (max-width: 640px) {
    .postRow { flex-direction: column; gap: 4px; }
    .right { white-space: normal; }
  }
</style>
