---
const BASE = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : import.meta.env.BASE_URL + "/";

const topItems = [
  { href: `${BASE}`, label: "ãƒ›ãƒ¼ãƒ ", icon: "â˜€ï¸" },
  { href: `${BASE}all`, label: "è¨˜äº‹ä¸€è¦§", icon: "ğŸ—‚" },
];

const catItems = [
  { href: `${BASE}category/zatsuki`, label: "é›‘è¨˜", icon: "ğŸ—’ï¸" },
  { href: `${BASE}category/analysis`, label: "åˆ†æ", icon: "ğŸª“" },
  { href: `${BASE}category/creation`, label: "å‰µä½œ", icon: "ğŸª„" },
  { href: `${BASE}category/shokai`, label: "ç´¹ä»‹", icon: "ğŸ—ï¸" },
];
---

<button id="sunFab" class="sunFab" type="button" aria-label="menu" aria-expanded="false">
  â˜€ï¸
</button>

<nav id="sunMenu" class="sunMenu" data-open="false" aria-label="site navigation">
  <div class="sunInner">
    {topItems.map((it) => (
      <a href={it.href} class="sunLink">
        <span class="sunIcon" aria-hidden="true">{it.icon}</span>
        <span class="sunLabel">{it.label}</span>
      </a>
    ))}

    <div class="sunDivider" aria-hidden="true">â€”â€”â€”</div>

    {catItems.map((it) => (
      <a href={it.href} class="sunLink">
        <span class="sunIcon" aria-hidden="true">{it.icon}</span>
        <span class="sunLabel">{it.label}</span>
      </a>
    ))}
  </div>

</nav>
<style>
  .sunMenu {
    width: 150px;              /* slimmer overall width */
    max-width: 70vw;
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(4px);
    border-right: 1px solid rgba(0,0,0,0.06);
  }

  .sunInner {
    padding: 10px 10px;
  }

  .sunLink {
    display: flex;
    gap: 6px;
    align-items: center;
    padding: 4px 0;
    text-decoration: none;
    color: var(--ink);
    font-size: 0.88rem;
    letter-spacing: 0.02em;
  }

  .sunIcon {
    width: 1.2em;
    text-align: center;
    font-size: 0.95em;
  }

  .sunLabel {
    font-size: 0.88rem;
  }

  .sunDivider {
    margin: 6px 0;
    height: 1px;
    background: rgba(0,0,0,0.08);
    font-size: 0;
  }
</style>

<script is:inline>
  (function () {
    function onReady(fn) {
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", fn, { once: true });
      } else {
        fn();
      }
    }

    onReady(function () {
      var btn = document.getElementById("sunFab");
      var menu = document.getElementById("sunMenu");
      var page = document.getElementById("pageWrap");
      if (!btn || !menu || !page) return;

      function setOpen(next) {
        menu.setAttribute("data-open", next ? "true" : "false");
        page.setAttribute("data-shift", next ? "true" : "false");
        btn.setAttribute("aria-expanded", next ? "true" : "false");
      }

      btn.addEventListener("click", function () {
        var open = menu.getAttribute("data-open") === "true";
        setOpen(!open);
      });

      document.addEventListener("keydown", function (e) {
        if (e && e.key === "Escape") setOpen(false);
      });

      menu.addEventListener("click", function (e) {
        var t = e && e.target;
        var a = null;
        if (t && t.closest) a = t.closest("a");
        if (a) setOpen(false);
      });

      // click outside closes
      document.addEventListener("click", function (e) {
        var t = e && e.target;
        if (!t) return;
        var open = menu.getAttribute("data-open") === "true";
        if (!open) return;
        if (btn.contains(t)) return;
        if (menu.contains(t)) return;
        setOpen(false);
      });
    });
  })();
</script>
