---
const BASE = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : import.meta.env.BASE_URL + "/";

const topItems = [
  { href: `${BASE}`, label: "„Éõ„Éº„É†", icon: "‚òÄÔ∏è" },
  { href: `${BASE}all`, label: "Ë®ò‰∫ã", icon: "üóÇÔ∏è" },
  { href: `${BASE}translation`, label: "Á†îÁ©∂ÔºèÁøªË®≥", icon: "üóíÔ∏è" },
  { href: `${BASE}novel`, label: "Â∞èË™¨", icon: "üèùÔ∏è" },
];
---
<nav id="sunMenu" class="sunMenu" data-open="false" aria-label="site navigation">
  <div class="sunInner">
    {topItems.map((it) => (
      <>
        <a href={it.href} class="sunLink">
          {it.icon ? <span class="sunIcon" aria-hidden="true">{it.icon}</span> : null}
          <span class="sunLabel">{it.label}</span>
        </a>
      </>
    ))}
  </div>

</nav>
<style>
  .sunMenu {
    position: fixed;
    top: var(--site-header-bottom, var(--float-panel-top-current, var(--float-panel-top)));
    left: 50%;
    transform: translate(-50%, -8px);
    width: min(940px, calc(100vw - 40px));
    background: rgba(252, 249, 242, 0.98);
    border: 1px solid var(--line);
    box-shadow: var(--shadow);
    border-radius: 0 0 12px 12px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.18s ease, transform 0.18s ease;
    z-index: 35;
  }

  .sunMenu[data-open="true"] {
    opacity: 1;
    pointer-events: auto;
    transform: translate(-50%, 0);
  }

  .sunInner {
    padding: 10px 16px;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px 12px;
  }

  .sunLink {
    display: inline-flex;
    gap: 6px;
    align-items: center;
    padding: 3px 0;
    text-decoration: none;
    color: var(--muted);
    font-size: 0.84rem;
    letter-spacing: 0.02em;
  }

  .sunIcon {
    width: 1.2em;
    text-align: center;
    font-size: 0.95em;
  }

  .sunLabel {
    font-size: 0.88rem;
  }

</style>

<script is:inline>
  (function () {
    function onReady(fn) {
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", fn, { once: true });
      } else {
        fn();
      }
    }

    onReady(function () {
      var btn = document.getElementById("sunFab");
      var menu = document.getElementById("sunMenu");
      if (!btn || !menu) return;

      function syncPanelTop() {
        var header = document.querySelector(".siteHeader");
        if (!header) return;
        var rect = header.getBoundingClientRect();
        var top = Math.max(0, Math.ceil(rect.bottom));
        document.documentElement.style.setProperty("--float-panel-top-current", top + "px");
      }

      syncPanelTop();
      window.addEventListener("resize", syncPanelTop);
      if (document.fonts && document.fonts.ready) {
        document.fonts.ready.then(syncPanelTop).catch(function () {});
      }

      function setOpen(next) {
        if (next) syncPanelTop();
        menu.setAttribute("data-open", next ? "true" : "false");
        btn.setAttribute("aria-expanded", next ? "true" : "false");
        if (next) {
          window.dispatchEvent(new CustomEvent("floatingPanelOpen", { detail: "sun" }));
        } else {
          btn.focus();
        }
      }

      btn.addEventListener("click", function () {
        var open = menu.getAttribute("data-open") === "true";
        setOpen(!open);
      });

      document.addEventListener("keydown", function (e) {
        if (e && e.key === "Escape") setOpen(false);
      });

      menu.addEventListener("click", function (e) {
        var t = e && e.target;
        var a = null;
        if (t && t.closest) a = t.closest("a");
        if (a) setOpen(false);
      });

      // click outside closes
      document.addEventListener("click", function (e) {
        var t = e && e.target;
        if (!t) return;
        var open = menu.getAttribute("data-open") === "true";
        if (!open) return;
        if (btn.contains(t)) return;
        if (menu.contains(t)) return;
        setOpen(false);
      });

      window.addEventListener("floatingPanelOpen", function (e) {
        var kind = e && e.detail;
        if (kind === "sun") return;
        setOpen(false);
      });
    });
  })();
</script>
